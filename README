An attempt to make sense of all that mallet code...(not sure if its going to be successful)